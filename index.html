<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ðŸŽ„ 2026 Hiro Marker Party</title>

    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.0.0/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-particle-system-component@1.0.x/dist/aframe-particle-system-component.min.js"></script>

    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: sans-serif;
        }

        /* Essential for AR.js: Ensures the camera video is behind the canvas */
        .a-canvas {
            z-index: 1 !important;
        }
        #arjs-video {
            z-index: -1 !important;
        }

        /* Overlay UI */
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center;
            transition: opacity 0.5s;
        }
        
        .btn {
            background: linear-gradient(135deg, #ff0055, #ffaa00);
            border: none; padding: 15px 40px; color: white; 
            font-size: 18px; font-weight: bold; border-radius: 50px;
            cursor: pointer; box-shadow: 0 0 20px rgba(255, 170, 0, 0.5);
            margin-bottom: 20px;
            text-transform: uppercase;
        }
    </style>

    <script>
        function startExperience() {
            // Hide the overlay
            const overlay = document.querySelector('#overlay');
            overlay.style.opacity = '0';
            setTimeout(() => { overlay.style.display = 'none'; }, 500);

            // Force resize to fix mobile browser glitches
            window.dispatchEvent(new Event('resize'));
            
            // Play any sounds if you add them later
            // const sound = document.querySelector('#bg-music');
            // sound.play();
        }
    </script>
</head>

<body style="margin: 0; overflow: hidden;">

    <div id="overlay">
        <h1 style="color: white; margin-bottom: 10px;">READY FOR 2026?</h1>
        <p style="color: #ddd; margin-bottom: 30px;">Allow camera access when asked</p>
        <button class="btn" onclick="startExperience()">START PARTY</button>
        <p style="color: #aaa; font-size: 0.9em; margin-top: 20px;">Point camera at the<br><strong>Hiro Marker</strong></p>
    </div>

    <a-scene 
        embedded
        arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono;"
        renderer="logarithmicDepthBuffer: true; colorManagement: true; alpha: true;"
        vr-mode-ui="enabled: false">

        <a-assets>
            <a-asset-item id="tree-model" src="https://vazxmixjsiawhamofees.supabase.co/storage/v1/object/public/models/tree-spruce/model.gltf"></a-asset-item>
        </a-assets>

        <a-marker preset="hiro" smooth="true" smoothCount="5" smoothTolerance="0.01" smoothThreshold="2">

            <a-entity rotation="-90 0 0">
                
                <a-entity light="type: ambient; color: #BBB; intensity: 0.5"></a-entity>
                <a-entity light="type: direction; color: #FFF; intensity: 1; castShadow: true" position="-2 4 4"></a-entity>
                <a-entity light="type: point; color: #ffaa00; intensity: 1.5; distance: 5" position="0 2 1"></a-entity>

                <a-entity gltf-model="#tree-model" scale="4 4 4" position="0 0 0" shadow="receive: true"></a-entity>

                <a-dodecahedron color="#FFD700" radius="0.1" position="0 1.6 0" 
                    material="emissive: #ffaa00; emissiveIntensity: 0.6; metalness: 1; roughness: 0"
                    animation="property: rotation; to: 0 360 0; dur: 3000; loop: true; easing: linear">
                </a-dodecahedron>

                <a-sphere color="#d90429" radius="0.06" position="0.25 0.5 0.25" material="metalness: 0.7; roughness: 0.2"></a-sphere>
                <a-sphere color="#ffd700" radius="0.05" position="-0.2 0.9 0.15" material="metalness: 0.7; roughness: 0.2"></a-sphere>
                <a-sphere color="#ef233c" radius="0.05" position="0 1.2 -0.1" material="metalness: 0.7; roughness: 0.2"></a-sphere>
                <a-sphere color="#00ccff" radius="0.05" position="-0.15 0.6 -0.2" material="metalness: 0.7; roughness: 0.2"></a-sphere>

                <a-text value="2026" align="center" position="0 0.5 1.5" scale="2 2 2" color="#ffd700"
                    animation="property: position; to: 0 0.6 1.5; dir: alternate; dur: 1500; loop: true">
                </a-text>

                <a-entity position="0 2 -0.5"
                    particle-system="preset: default; particleCount: 800; color: #ff0000, #ffd700, #00ff00; size: 0.4; maxAge: 1; velocityValue: 0 6 0; velocitySpread: 3 2 3; accelerationValue: 0 -3 0;">
                </a-entity>
                
            </a-entity> 
        </a-marker>

        <a-entity camera></a-entity>
    </a-scene>

</body>
</html>